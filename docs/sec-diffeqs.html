<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US" dir="ltr">
<!--******************************************-->
<!--*  Authored with PreTeXt                 *-->
<!--*  pretextbook.org                       *-->
<!--*  Theme: default-modern                 *-->
<!--*  Palette: blue-red                     *-->
<!--******************************************-->
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Differential equations</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
<link href="_static/pretext/css/theme.css" rel="stylesheet" type="text/css">
<script>
var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  "tex": {
    "inlineMath": [
      [
        "\\(",
        "\\)"
      ]
    ],
    "tags": "none",
    "tagSide": "right",
    "tagIndent": ".8em",
    "packages": {
      "[+]": [
        "base",
        "extpfeil",
        "ams",
        "amscd",
        "color",
        "newcommand",
        "knowl"
      ]
    }
  },
  "options": {
    "ignoreHtmlClass": "tex2jax_ignore|ignore-math",
    "processHtmlClass": "process-math"
  },
  "chtml": {
    "scale": 0.98,
    "mtextInheritFont": true
  },
  "loader": {
    "load": [
      "input/asciimath",
      "[tex]/extpfeil",
      "[tex]/amscd",
      "[tex]/color",
      "[tex]/newcommand",
      "[pretext]/mathjaxknowl3.js"
    ],
    "paths": {
      "pretext": "_static/pretext/js/lib"
    }
  },
  "startup": {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  }
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="PreFigure Author’s Guide">
<meta property="book:author" content="David Austin">
<script src="_static/pretext/js/lib/jquery.min.js"></script><script src="_static/pretext/js/lib/jquery.sticky.js"></script><script src="_static/pretext/js/lib/jquery.espy.min.js"></script><script src="_static/pretext/js/pretext.js"></script><script src="_static/pretext/js/pretext_add_on.js?x=1"></script><script src="_static/pretext/js/user_preferences.js"></script><!--** eBookCongig is necessary to configure interactive       **-->
<!--** Runestone components to run locally in reader's browser **-->
<!--** No external communication:                              **-->
<!--**     log level is 0, Runestone Services are disabled     **-->
<script type="text/javascript">
eBookConfig = {};
eBookConfig.useRunestoneServices = false;
eBookConfig.host = 'http://127.0.0.1:8000';
eBookConfig.course = 'PTX_Course_Title_Here';
eBookConfig.basecourse = 'PTX_Base_Course';
eBookConfig.isLoggedIn = false;
eBookConfig.email = '';
eBookConfig.isInstructor = false;
eBookConfig.logLevel = 0;
eBookConfig.username = '';
eBookConfig.readings = null;
eBookConfig.activities = null;
eBookConfig.downloadsEnabled = false;
eBookConfig.allow_pairs = false;
eBookConfig.enableScratchAC = false;
eBookConfig.build_info = "";
eBookConfig.python3 = null;
eBookConfig.runestone_version = '7.9.1';
eBookConfig.jobehost = '';
eBookConfig.proxyuri_runs = '';
eBookConfig.proxyuri_files = '';
eBookConfig.enable_chatcodes =  false;
</script>
<!--*** Runestone Services ***-->
<script src="_static/prefix-runtime.787a04695534ef1e.bundle.js"></script><script src="_static/prefix-723.3e6434f80549315a.bundle.js"></script><script src="_static/prefix-runestone.014cb392a13bd045.bundle.js"></script><link rel="stylesheet" type="text/css" href="_static/prefix-723.3bccd435914aa0ff.css">
<link rel="stylesheet" type="text/css" href="_static/prefix-runestone.8141ae22fd347e48.css">
<script src="_static/pretext/js/diagcess/diagcess.js"></script><link rel="icon" type="image/png" sizes="32x32" href="external/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="external/favicon/favicon-16x16.png">
<script src="_static/pretext/js/lti_iframe_resizer.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-numbers/prism-line-numbers.min.js" integrity="sha512-dubtf8xMHSQlExGRQ5R7toxHLgSDZ0K7AunqPWHXmJQ8XyVIG19S1T95gBxlAeGOK02P4Da2RTnQz0Za0H0ebQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-highlight/prism-line-highlight.min.js" integrity="sha512-93uCmm0q+qO5Lb1huDqr7tywS8A2TFA+1/WHvyiWaK6/pvsFl6USnILagntBx8JnVbQH5s3n0vQZY6xNthNfKA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="_static/pretext/js/pretext_search.js"></script><script src="_static/pretext/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script>
</head>
<body id="prefigure" class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner">
<a id="logo-link" class="logo-link" target="_blank" href="https://prefigure.org"><img src="external/images/logo.png" alt="Logo image"></a><div class="title-container">
<h1 class="heading"><a href="pr-guide.html"><span class="title">PreFigure Author’s Guide</span></a></h1>
<p class="byline">David Austin</p>
</div>
</div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><div class="ptx-navbar-contents">
<button class="toc-toggle button" title="Contents"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5d2;</span><span class="name">Contents</span></button><div class="searchbox">
<div class="searchwidget"><button id="searchbutton" class="searchbutton button" type="button" title="Search book"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe8b6;</span><span class="name">Search Book</span></button></div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<div class="search-results-controls">
<input aria-label="Search term" id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search term"><button title="Close search" id="closesearchresults" class="closesearchresults"><span class="material-symbols-outlined">close</span></button>
</div>
<h2 class="search-results-heading">Search Results: </h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div>
<span class="nav-other-controls"><button id="light-dark-button" class="light-dark-button button" title="Dark Mode"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe51c;</span><span class="name">Dark Mode</span></button></span><span class="treebuttons"><a class="previous-button button" href="sec-calculus.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="up-button button" href="chap-graphical.html" title="Up"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Up</span></a><a class="next-button button" href="sec-networks.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a></span>
</div></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\N}{\mathbb N}
\newcommand{\Z}{\mathbb Z}
\newcommand{\Q}{\mathbb Q}
\newcommand{\R}{\mathbb R}
\newcommand{\yvec}{\mathbf y}
\newcommand{\twovec}[2]{\left[\begin{array}{r}#1 \\ #2
\end{array}\right]}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth2 focused" data-preexpanded-levels="2" data-max-levels="2"><ul class="structural toc-item-list contains-active">
<li class="toc-item toc-frontmatter"><div class="toc-title-box"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div></li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap-introduction.html" class="internal"><span class="codenumber">1</span> <span class="title">Introduction</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-example.html" class="internal"><span class="codenumber">1.1</span> <span class="title">An example diagram</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-accessibility.html" class="internal"><span class="codenumber">1.2</span> <span class="title">Accessibility</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-gallery.html" class="internal"><span class="codenumber">1.3</span> <span class="title">A gallery of diagrams</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-installation.html" class="internal"><span class="codenumber">1.4</span> <span class="title">Installation and use</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap-start.html" class="internal"><span class="codenumber">2</span> <span class="title">Getting Started</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-diagram.html" class="internal"><span class="codenumber">2.1</span> <span class="title">The <code class="code-inline tex2jax_ignore">&lt;diagram&gt;</code>element</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-coordinates.html" class="internal"><span class="codenumber">2.2</span> <span class="title">The <code class="code-inline tex2jax_ignore">&lt;coordinates&gt;</code> element</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-definition.html" class="internal"><span class="codenumber">2.3</span> <span class="title">The <code class="code-inline tex2jax_ignore">&lt;definition&gt;</code> element and user namespace</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter contains-active">
<div class="toc-title-box"><a href="chap-graphical.html" class="internal"><span class="codenumber">3</span> <span class="title">Graphical components</span></a></div>
<ul class="structural toc-item-list contains-active">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-graphical-attr.html" class="internal"><span class="codenumber">3.1</span> <span class="title">Stroke, fill, and other graphical attributes</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-graphical-attr.html#subsec-colors" class="internal"><span class="codenumber">3.1.1</span> <span class="title">Colors</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-graphical-attr.html#subsec-stroke-attributes" class="internal"><span class="codenumber">3.1.2</span> <span class="title">Stroke attributes</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-graphical-attr.html#sec-graphical-attr-5" class="internal"><span class="codenumber">3.1.3</span> <span class="title">Fill attributes</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-graphical-attr.html#sec-graphical-attr-6" class="internal"><span class="codenumber">3.1.4</span> <span class="title">Handles</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-outlining.html" class="internal"><span class="codenumber">3.2</span> <span class="title">Outlining and <code class="code-inline tex2jax_ignore">&lt;group&gt;</code>s</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-outlining.html#sec-outlining-3" class="internal"><span class="codenumber">3.2.1</span> <span class="title">Outlining</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-outlining.html#sec-outlining-4" class="internal"><span class="codenumber">3.2.2</span> <span class="title">Groups</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-grid-axes.html" class="internal"><span class="codenumber">3.3</span> <span class="title">Grid and Axes</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-grid-axes.html#subsec-grid-axes" class="internal"><span class="codenumber">3.3.1</span> <span class="title"><code class="code-inline tex2jax_ignore">&lt;grid-axes&gt;</code></span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-grid-axes.html#subsec-grid" class="internal"><span class="codenumber">3.3.2</span> <span class="title">Grids</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-grid-axes.html#subsec-axes" class="internal"><span class="codenumber">3.3.3</span> <span class="title">Axes</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-grid-axes.html#sec-grid-axes-6" class="internal"><span class="codenumber">3.3.4</span> <span class="title">Tick marks</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-labels.html" class="internal"><span class="codenumber">3.4</span> <span class="title">Labels</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-labels.html#sec-labels-3" class="internal"><span class="codenumber">3.4.1</span> <span class="title">Creating labels</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-labels.html#sec-labels-4" class="internal"><span class="codenumber">3.4.2</span> <span class="title">Legends</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-simple.html" class="internal"><span class="codenumber">3.5</span> <span class="title">Points, lines, and polygons</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-simple.html#subsec-points" class="internal"><span class="codenumber">3.5.1</span> <span class="title">Points</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-simple.html#sec-simple-4" class="internal"><span class="codenumber">3.5.2</span> <span class="title">Lines</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-simple.html#subsec-vectors" class="internal"><span class="codenumber">3.5.3</span> <span class="title">Vectors</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-simple.html#sec-simple-6" class="internal"><span class="codenumber">3.5.4</span> <span class="title">Polygons</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-simple.html#subsec-splines" class="internal"><span class="codenumber">3.5.5</span> <span class="title">Splines</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-simple.html#sec-simple-8" class="internal"><span class="codenumber">3.5.6</span> <span class="title">Triangles</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-circles.html" class="internal"><span class="codenumber">3.6</span> <span class="title">Circles, ellipses, and rectangles</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-circles.html#subsec-circles" class="internal"><span class="codenumber">3.6.1</span> <span class="title">Circles</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-circles.html#sec-circles-4" class="internal"><span class="codenumber">3.6.2</span> <span class="title">Arcs</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-circles.html#sec-circles-5" class="internal"><span class="codenumber">3.6.3</span> <span class="title">Angle markers</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-circles.html#sec-circles-6" class="internal"><span class="codenumber">3.6.4</span> <span class="title">Rectangles</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-calculus.html" class="internal"><span class="codenumber">3.7</span> <span class="title">Calculus components</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-calculus.html#subsec-graph" class="internal"><span class="codenumber">3.7.1</span> <span class="title">Graphs and tangent lines</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-calculus.html#sec-calculus-4" class="internal"><span class="codenumber">3.7.2</span> <span class="title">Parametric curves</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-calculus.html#sec-calculus-5" class="internal"><span class="codenumber">3.7.3</span> <span class="title">Implicit curves</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-calculus.html#sec-calculus-6" class="internal"><span class="codenumber">3.7.4</span> <span class="title">Areas</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-calculus.html#sec-calculus-7" class="internal"><span class="codenumber">3.7.5</span> <span class="title">Riemann sums</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-calculus.html#sec-calculus-8" class="internal"><span class="codenumber">3.7.6</span> <span class="title">Vector fields and gradients</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-calculus.html#sec-calculus-9" class="internal"><span class="codenumber">3.7.7</span> <span class="title">Polar coordinates</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section contains-active">
<div class="toc-title-box"><a href="sec-diffeqs.html" class="internal"><span class="codenumber">3.8</span> <span class="title">Differential equations</span></a></div>
<ul class="structural toc-item-list active">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-diffeqs.html#subsec-slope-field" class="internal"><span class="codenumber">3.8.1</span> <span class="title">Slope Fields</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-diffeqs.html#subsec-de-solutions" class="internal"><span class="codenumber">3.8.2</span> <span class="title">Solutions to differential equations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-diffeqs.html#sec-diffeqs-5" class="internal"><span class="codenumber">3.8.3</span> <span class="title">Discontinuities</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-diffeqs.html#subsec-delta" class="internal"><span class="codenumber">3.8.4</span> <span class="title">Delta functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-diffeqs.html#subsec-euler" class="internal"><span class="codenumber">3.8.5</span> <span class="title">Euler’s method</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-networks.html" class="internal"><span class="codenumber">3.9</span> <span class="title">Networks</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-networks.html#sec-networks-3" class="internal"><span class="codenumber">3.9.1</span> <span class="title">Getting started</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-networks.html#sec-networks-4" class="internal"><span class="codenumber">3.9.2</span> <span class="title">A more verbose network</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-networks.html#sec-networks-5" class="internal"><span class="codenumber">3.9.3</span> <span class="title">Positioning the nodes</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-networks.html#sec-networks-6" class="internal"><span class="codenumber">3.9.4</span> <span class="title">Putting everything together</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-networks.html#sec-networks-7" class="internal"><span class="codenumber">3.9.5</span> <span class="title">Annotating networks</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-paths.html" class="internal"><span class="codenumber">3.10</span> <span class="title">Paths</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-paths.html#sec-paths-3" class="internal"><span class="codenumber">3.10.1</span> <span class="title">Defining paths</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-paths.html#sec-paths-4" class="internal"><span class="codenumber">3.10.2</span> <span class="title">Decorations</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-shapes.html" class="internal"><span class="codenumber">3.11</span> <span class="title">Shape constructions and clipping</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-shapes.html#sec-shapes-3" class="internal"><span class="codenumber">3.11.1</span> <span class="title">Defining shapes</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-shapes.html#sec-shapes-4" class="internal"><span class="codenumber">3.11.2</span> <span class="title">Shape Constructions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-shapes.html#sec-shapes-5" class="internal"><span class="codenumber">3.11.3</span> <span class="title">Clipping</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-data.html" class="internal"><span class="codenumber">3.12</span> <span class="title">Working with data</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data.html#sec-data-3" class="internal"><span class="codenumber">3.12.1</span> <span class="title">Reading an external file</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data.html#sec-data-4" class="internal"><span class="codenumber">3.12.2</span> <span class="title">Scatter plots</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data.html#sec-data-5" class="internal"><span class="codenumber">3.12.3</span> <span class="title">Histograms</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data.html#sec-data-6" class="internal"><span class="codenumber">3.12.4</span> <span class="title">Plotting a trajectory</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-data.html#sec-data-7" class="internal"><span class="codenumber">3.12.5</span> <span class="title">Log plots</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap-project.html" class="internal"><span class="codenumber">4</span> <span class="title">Managing a PreFigure project</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-publication.html" class="internal"><span class="codenumber">4.1</span> <span class="title">The publication file</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-pretext.html" class="internal"><span class="codenumber">4.2</span> <span class="title">Authoring diagrams within PreTeXt</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap-next-steps.html" class="internal"><span class="codenumber">5</span> <span class="title">Next steps</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-repeat.html" class="internal"><span class="codenumber">5.1</span> <span class="title">The <code class="code-inline tex2jax_ignore">&lt;repeat&gt;</code> element</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-arrows.html" class="internal"><span class="codenumber">5.2</span> <span class="title">Arrows</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-transforms.html" class="internal"><span class="codenumber">5.3</span> <span class="title">Transforms</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-transforms.html#subsec-transforms" class="internal"><span class="codenumber">5.3.1</span> <span class="title">The <code class="code-inline tex2jax_ignore">&lt;transform&gt;</code> element</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-transforms.html#subsec-group-transform" class="internal"><span class="codenumber">5.3.2</span> <span class="title">Transforming a <code class="code-inline tex2jax_ignore">&lt;group&gt;</code></span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-math.html" class="internal"><span class="codenumber">5.4</span> <span class="title">Mathematical operations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-math.html#sec-math-3" class="internal"><span class="codenumber">5.4.1</span> <span class="title">Math operations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-math.html#sec-math-4" class="internal"><span class="codenumber">5.4.2</span> <span class="title">Intersections</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-math.html#sec-math-5" class="internal"><span class="codenumber">5.4.3</span> <span class="title">Vector operations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-math.html#sec-math-6" class="internal"><span class="codenumber">5.4.4</span> <span class="title">List operations</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="chap-accessibility.html" class="internal"><span class="codenumber">6</span> <span class="title">Accessibility</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-annotations.html" class="internal"><span class="codenumber">6.1</span> <span class="title">Annotating a diagram</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-annotations.html#sec-annotations-3" class="internal"><span class="codenumber">6.1.1</span> <span class="title">The <code class="code-inline tex2jax_ignore">diagcess</code> library</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-annotations.html#sec-annotations-4" class="internal"><span class="codenumber">6.1.2</span> <span class="title">The annotation tree</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-annotations.html#sec-annotations-5" class="internal"><span class="codenumber">6.1.3</span> <span class="title">Annotations within repeat elements</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-tactile.html" class="internal"><span class="codenumber">6.2</span> <span class="title">Tactile diagrams</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-tactile.html#sec-tactile-3" class="internal"><span class="codenumber">6.2.1</span> <span class="title">Anatomy of a tactile diagram</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-tactile.html#sec-tactile-4" class="internal"><span class="codenumber">6.2.2</span> <span class="title">PreFigure considerations for tactile diagrams</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-tactile.html#subsec-tactile-captions" class="internal"><span class="codenumber">6.2.3</span> <span class="title">Captions in tactile diagrams</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter"><div class="toc-title-box"><a href="chap-examples.html" class="internal"><span class="codenumber">7</span> <span class="title">Examples with source</span></a></div></li>
<li class="toc-item toc-backmatter"><div class="toc-title-box"><a href="backmatter.html" class="internal"><span class="title">Backmatter</span></a></div></li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content"><section class="section" id="sec-diffeqs"><h2 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">3.8</span><span class="space"> </span><span class="title">Differential equations</span>
</h2>
<section class="introduction" id="sec-diffeqs-2"><div class="para" id="sec-diffeqs-2-1">There are a few elements for creating diagrams containing solutions to differential equations.<div class="autopermalink" data-description="Paragraph"><a href="#sec-diffeqs-2-1" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div></section><section class="subsection" id="subsec-slope-field"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">3.8.1</span><span class="space"> </span><span class="title">Slope Fields</span>
</h3>
<div class="para logical" id="subsec-slope-field-2">
<div class="para">Slope fields for a 1-variable ordinary differential equation and for autonomous <span class="process-math">\(2\times2\)</span> systems can be drawn using the <code class="code-inline tex2jax_ignore">&lt;slope-field&gt;</code> element.  On the left of <a href="sec-diffeqs.html#diagram-slope-field" class="xref" data-knowl="./knowl/xref/diagram-slope-field.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 3.8.1">Figure 3.8.1</a> is shown a slope field for the equation</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/diagram-slope-field.html">
\begin{equation*}
\frac{dy}{dt}=t-y
\end{equation*}
</div>
<div class="para">while the right shows the slope field for the autonomous system</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/diagram-slope-field.html">
\begin{equation*}
\frac{d}{dt}\twovec{y_0}{y_1} = \twovec{y_1}{-y_0}.
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#subsec-slope-field-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<figure class="figure figure-like" id="diagram-slope-field"><div class="sidebyside"><div class="sbsrow" style="margin-left:2.5%;margin-right:2.5%;">
<div class="sbspanel top" style="width:47.3684210526316%;"><img src="external/images/slope-field.svg" role="img" class="contained"></div>
<div class="sbspanel top" style="width:47.3684210526316%;"><img src="external/images/slope-field-2.svg" role="img" class="contained"></div>
</div></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">3.8.1<span class="period">.</span></span><span class="space"> </span>The slope fields for two differential equations.<div class="autopermalink" data-description="Figure 3.8.1"><a href="#diagram-slope-field" title="Copy heading and permalink for Figure 3.8.1" aria-label="Copy heading and permalink for Figure 3.8.1">🔗</a></div></figcaption></figure><div class="para" id="subsec-slope-field-4">The PreFigure source input for the left diagram in <a href="sec-diffeqs.html#diagram-slope-field" class="xref" data-knowl="./knowl/xref/diagram-slope-field.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 3.8.1">Figure 3.8.1</a> is given in <a href="sec-diffeqs.html#listing-slope-field" class="xref" data-knowl="./knowl/xref/listing-slope-field.html" data-reveal-label="Reveal" data-close-label="Close" title="Listing 3.8.2: The PreFigure source for the slope field of a 1-variable differential equation">Listing 3.8.2</a>.<div class="autopermalink" data-description="Paragraph"><a href="#subsec-slope-field-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<figure class="listing figure-like" id="listing-slope-field"><figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">3.8.2<span class="period">.</span></span><span class="space"> </span>The PreFigure source for the slope field of a 1-variable differential equation<div class="autopermalink" data-description="Listing 3.8.2: The PreFigure source for the slope field of a 1-variable differential equation"><a href="#listing-slope-field" title="Copy heading and permalink for Listing 3.8.2: The PreFigure source for the slope field of a 1-variable differential equation" aria-label="Copy heading and permalink for Listing 3.8.2: The PreFigure source for the slope field of a 1-variable differential equation">🔗</a></div></figcaption><div class="listing__contents"><div class="code-box"><pre class="program clipboardable"><code class="language-none">&lt;diagram dimensions="(300,300)" margins="10"&gt;
  &lt;definition&gt;f(t,y) = t-y&lt;/definition&gt;
  &lt;coordinates bbox="[-4,-4,4,4]"&gt;
    &lt;grid-axes xlabel="t" ylabel="y"/&gt;
    &lt;slope-field function="f"/&gt;
  &lt;/coordinates&gt;
&lt;/diagram&gt;
</code></pre></div></div></figure><div class="para" id="subsec-slope-field-6">The grid on which the slope field is drawn can be changed using the <code class="code-inline tex2jax_ignore">@spacings</code> attribute similar to that of the <a href="sec-grid-axes.html#subsec-grid" class="internal" title="Subsection 3.3.2: Grids">grid element</a>.<div class="autopermalink" data-description="Paragraph"><a href="#subsec-slope-field-6" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="subsec-slope-field-7">To obtain the slope field for an autonomous system, include the attribute <code class="code-inline tex2jax_ignore">@system="yes"</code> in the <code class="code-inline tex2jax_ignore">&lt;slope-field&gt;</code> element.  Also, arrows are added to the <code class="code-inline tex2jax_ignore">&lt;slope-field&gt;</code> using the <code class="code-inline tex2jax_ignore">@arrows="yes"</code> attribute.  Notice that the function defining the differential equation is naturally vector-valued now.<div class="autopermalink" data-description="Paragraph"><a href="#subsec-slope-field-7" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<figure class="listing figure-like" id="listing-slope-field-2"><figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">3.8.3<span class="period">.</span></span><span class="space"> </span>The PreFigure source for the slope field of an autonomous sytem.<div class="autopermalink" data-description="Listing 3.8.3: The PreFigure source for the slope field of an autonomous sytem."><a href="#listing-slope-field-2" title="Copy heading and permalink for Listing 3.8.3: The PreFigure source for the slope field of an autonomous sytem." aria-label="Copy heading and permalink for Listing 3.8.3: The PreFigure source for the slope field of an autonomous sytem.">🔗</a></div></figcaption><div class="listing__contents"><div class="code-box"><pre class="program clipboardable"><code class="language-none">&lt;diagram dimensions="(300,300)" margins="10"&gt;
  &lt;definition&gt;f(t,y) = (y[1],-y[0])&lt;/definition&gt;
  &lt;coordinates bbox="[-4,-4,4,4]"&gt;
    &lt;grid-axes xlabel="y_0" ylabel="y_1"/&gt;
    &lt;slope-field function="f" system="yes" arrows="yes"/&gt;
  &lt;/coordinates&gt;
&lt;/diagram&gt;
</code></pre></div></div></figure><div class="autopermalink" data-description="Subsection 3.8.1: Slope Fields"><a href="#subsec-slope-field" title="Copy heading and permalink for Subsection 3.8.1: Slope Fields" aria-label="Copy heading and permalink for Subsection 3.8.1: Slope Fields">🔗</a></div></section><section class="subsection" id="subsec-de-solutions"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">3.8.2</span><span class="space"> </span><span class="title">Solutions to differential equations</span>
</h3>
<div class="para" id="subsec-de-solutions-2">PreFigure provides an element <code class="code-inline tex2jax_ignore">&lt;de-solve&gt;</code> that generates and saves the solution of a differential equation.  You could think of this as a definition that can be reused possibly several times.<div class="autopermalink" data-description="Paragraph"><a href="#subsec-de-solutions-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="subsec-de-solutions-3">Solutions are then plotted using the <code class="code-inline tex2jax_ignore">&lt;plot-de-solution&gt;</code> element.  <a href="sec-diffeqs.html#diagram-de-plot" class="xref" data-knowl="./knowl/xref/diagram-de-plot.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 3.8.4">Figure 3.8.4</a> demonstrates how to use these elements.<div class="autopermalink" data-description="Paragraph"><a href="#subsec-de-solutions-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<figure class="figure figure-like" id="diagram-de-plot"><div class="sidebyside"><div class="sbsrow" style="margin-left:20%;margin-right:20%;"><div class="sbspanel top" style="width:100%;"><img src="external/images/de-plot.svg" role="img" class="contained"></div></div></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">3.8.4<span class="period">.</span></span><span class="space"> </span>Some solutions to a differential equation.<div class="autopermalink" data-description="Figure 3.8.4"><a href="#diagram-de-plot" title="Copy heading and permalink for Figure 3.8.4" aria-label="Copy heading and permalink for Figure 3.8.4">🔗</a></div></figcaption></figure><figure class="listing figure-like" id="listing-de-plot"><figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">3.8.5<span class="period">.</span></span><span class="space"> </span>The PreFigure source for Figure 3.8.4.<div class="autopermalink" data-description="Listing 3.8.5: The PreFigure source for Figure 3.8.4."><a href="#listing-de-plot" title="Copy heading and permalink for Listing 3.8.5: The PreFigure source for Figure 3.8.4." aria-label="Copy heading and permalink for Listing 3.8.5: The PreFigure source for Figure 3.8.4.">🔗</a></div></figcaption><div class="listing__contents"><div class="code-box"><pre class="program clipboardable line-numbers"><code class="language-none">&lt;diagram dimensions="(300,300)" margins="12"&gt;
  &lt;definition&gt;f(t,y) = t-y&lt;/definition&gt;
  &lt;coordinates bbox="[-4,-4,4,4]"&gt;
    &lt;grid-axes/&gt;
    &lt;slope-field function="f"/&gt;
    &lt;de-solve function="f" t0="0" y0="3" t1="4" name="linear"/&gt;
    &lt;plot-de-solution solution="linear" stroke="red"/&gt;
    &lt;plot-de-solution function="f" t0="0" y0="-2" t1="4" stroke="red"/&gt;
  &lt;/coordinates&gt;
&lt;/diagram&gt;
</code></pre></div></div></figure><div class="para" id="subsec-de-solutions-6">
<a href="sec-diffeqs.html#listing-de-plot" class="xref" data-knowl="./knowl/xref/listing-de-plot.html" data-reveal-label="Reveal" data-close-label="Close" title="Listing 3.8.5: The PreFigure source for Figure 3.8.4.">Listing 3.8.5</a> shows two ways in which a solution to the differential equation can be plotted.  In Line 5, we solve the differential equation with initial value <span class="process-math">\(y(t_0)=y_0\)</span> over the interval <span class="process-math">\(t_0\leq t\leq t_1\text{.}\)</span> This interval is broken into <code class="code-inline tex2jax_ignore">@N=100</code> steps by default, but this value can be modified using the <code class="code-inline tex2jax_ignore">@N</code> attribute.  This solution is also given an attribute <code class="code-inline tex2jax_ignore">@name="linear"</code>. To plot the solution, we use a <code class="code-inline tex2jax_ignore">&lt;plot-de-solution&gt;</code> element in Line 7 passing the name of the solution as an attribute.<div class="autopermalink" data-description="Paragraph"><a href="#subsec-de-solutions-6" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="subsec-de-solutions-7">Alernatively, these two elements can be combined into a single <code class="code-inline tex2jax_ignore">&lt;plot-de-solution&gt;</code> element, as shown in Line 8.  Most likely, you will use this second method more frequently since it involves a single element.<div class="autopermalink" data-description="Paragraph"><a href="#subsec-de-solutions-7" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="subsec-de-solutions-8">There are more possibilities when solving a system.  <a href="sec-diffeqs.html#diagram-de-plot-2" class="xref" data-knowl="./knowl/xref/diagram-de-plot-2.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 3.8.6">Figure 3.8.6</a> shows a solution to a <span class="process-math">\(2\times2\)</span> autonomous system.<div class="autopermalink" data-description="Paragraph"><a href="#subsec-de-solutions-8" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<figure class="figure figure-like" id="diagram-de-plot-2"><div class="sidebyside"><div class="sbsrow" style="margin-left:20%;margin-right:20%;"><div class="sbspanel top" style="width:100%;"><img src="external/images/de-plot-2.svg" role="img" class="contained"></div></div></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">3.8.6<span class="period">.</span></span><span class="space"> </span>Solutions <span class="process-math">\(y_0(t)\)</span> and <span class="process-math">\(y_1(t)\)</span> to a system of differential equations.<div class="autopermalink" data-description="Figure 3.8.6"><a href="#diagram-de-plot-2" title="Copy heading and permalink for Figure 3.8.6" aria-label="Copy heading and permalink for Figure 3.8.6">🔗</a></div></figcaption></figure><figure class="listing figure-like" id="listing-de-plot-2"><figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">3.8.7<span class="period">.</span></span><span class="space"> </span>The PreFigure source for Figure 3.8.6.<div class="autopermalink" data-description="Listing 3.8.7: The PreFigure source for Figure 3.8.6."><a href="#listing-de-plot-2" title="Copy heading and permalink for Listing 3.8.7: The PreFigure source for Figure 3.8.6." aria-label="Copy heading and permalink for Listing 3.8.7: The PreFigure source for Figure 3.8.6.">🔗</a></div></figcaption><div class="listing__contents"><div class="code-box"><pre class="program clipboardable line-numbers"><code class="language-none">&lt;diagram dimensions="(300,300)" margins="12"&gt;
  &lt;definition&gt;f(t,y) = (y[1],-y[0])&lt;/definition&gt;
  &lt;coordinates bbox="[-1,-4,6,4]"&gt;
    &lt;grid-axes/&gt;
    &lt;de-solve function="f" t0="0" t1="6" y0="(3,0)" name="oscillator"/&gt;
    &lt;plot-de-solution solution="oscillator" axes="(t,y0)"/&gt;
    &lt;plot-de-solution solution="oscillator" axes="(t,y1)" stroke="red"/&gt;
  &lt;/coordinates&gt;
&lt;/diagram&gt;
</code></pre></div></div></figure><div class="para" id="subsec-de-solutions-11">Notice how we generate a solution in Line 5 of <a href="sec-diffeqs.html#listing-de-plot-2" class="xref" data-knowl="./knowl/xref/listing-de-plot-2.html" data-reveal-label="Reveal" data-close-label="Close" title="Listing 3.8.7: The PreFigure source for Figure 3.8.6.">Listing 3.8.7</a> and save it with the <code class="code-inline tex2jax_ignore">@name="oscillator"</code>.  Then we reuse this solution to plot the components <span class="process-math">\(y_0\)</span> and <span class="process-math">\(y_1\)</span> as functions of <span class="process-math">\(t\)</span> in Line 6 and 7.  There are now three quantities involved, <span class="process-math">\(t\text{,}\)</span> <span class="process-math">\(y_0\text{,}\)</span> and <span class="process-math">\(y_1\text{,}\)</span> so we use the <code class="code-inline tex2jax_ignore">@axes</code> attribute to state which of these quantities will appear on the horizontal and vertical axis.  This notation for the axes holds no matter what variables are used to define the function <span class="process-math">\(f\)</span> on the right side of the differential equation.<div class="autopermalink" data-description="Paragraph"><a href="#subsec-de-solutions-11" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="subsec-de-solutions-12">We can also create phase portraits as in <a href="sec-diffeqs.html#diagram-de-phase" class="xref" data-knowl="./knowl/xref/diagram-de-phase.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 3.8.8">Figure 3.8.8</a>.  The source code demonstrates how a <code class="code-inline tex2jax_ignore">@method</code> can be supplied to the differential equation solver.  Differential equations are solved numerically using a <a class="external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html" target="_blank">Python package</a><details class="ptx-footnote" aria-live="polite" id="subsec-de-solutions-12-4"><summary class="ptx-footnote__number" title="Footnote 3.8.1"><sup> 1 </sup></summary><div class="ptx-footnote__contents" id="subsec-de-solutions-12-4"><code class="code-inline tex2jax_ignore">docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html</code></div></details> that presents a choice of methods.  Most of the time, the default "RK45" method will suffice, but "LSODA" may be helpful when working with stiff equations.<div class="autopermalink" data-description="Paragraph"><a href="#subsec-de-solutions-12" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<figure class="figure figure-like" id="diagram-de-phase"><div class="sidebyside"><div class="sbsrow" style="margin-left:20%;margin-right:20%;"><div class="sbspanel top" style="width:100%;"><img src="external/images/de-phase.svg" role="img" class="contained"></div></div></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">3.8.8<span class="period">.</span></span><span class="space"> </span>A few trajectories in the phase plane of an autonomous system.<div class="autopermalink" data-description="Figure 3.8.8"><a href="#diagram-de-phase" title="Copy heading and permalink for Figure 3.8.8" aria-label="Copy heading and permalink for Figure 3.8.8">🔗</a></div></figcaption></figure><figure class="listing figure-like" id="listing-de-phase"><figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">3.8.9<span class="period">.</span></span><span class="space"> </span>The PreFigure source for Figure 3.8.8.<div class="autopermalink" data-description="Listing 3.8.9: The PreFigure source for Figure 3.8.8."><a href="#listing-de-phase" title="Copy heading and permalink for Listing 3.8.9: The PreFigure source for Figure 3.8.8." aria-label="Copy heading and permalink for Listing 3.8.9: The PreFigure source for Figure 3.8.8.">🔗</a></div></figcaption><div class="listing__contents"><div class="code-box"><pre class="program clipboardable line-numbers"><code class="language-none">&lt;diagram dimensions="(300,300)" margins="12"&gt;
  &lt;definition&gt;f(t,y) = (y[1],-y[0])&lt;/definition&gt;
  &lt;coordinates bbox="[-4,-4,4,4]"&gt;
    &lt;grid-axes xlabel="y_0" ylabel="y_1"/&gt;
    &lt;slope-field function="f" system="yes" stroke="darkorange"
		 arrows="yes"/&gt;
    &lt;plot-de-solution function="f" t0="0" t1="2*pi" 
		      y0="(1,0)" axes="(y0,y1)"/&gt;
    &lt;plot-de-solution function="f" t0="0" t1="2*pi" method="RK23"
		      y0="(2,0)" axes="(y0,y1)"/&gt;
    &lt;plot-de-solution function="f" t0="0" t1="2*pi" method="LSODA"
		      y0="(3,0)" axes="(y0,y1)"/&gt;
  &lt;/coordinates&gt;
&lt;/diagram&gt;
</code></pre></div></div></figure><div class="para" id="subsec-de-solutions-15">To place an arrow at the end of a trajectory, add the attribute <code class="code-inline tex2jax_ignore">@arrow="yes"</code> to the <code class="code-inline tex2jax_ignore">&lt;plot-de-solution&gt;</code> element.<div class="autopermalink" data-description="Paragraph"><a href="#subsec-de-solutions-15" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Subsection 3.8.2: Solutions to differential equations"><a href="#subsec-de-solutions" title="Copy heading and permalink for Subsection 3.8.2: Solutions to differential equations" aria-label="Copy heading and permalink for Subsection 3.8.2: Solutions to differential equations">🔗</a></div></section><section class="subsection" id="sec-diffeqs-5"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">3.8.3</span><span class="space"> </span><span class="title">Discontinuities</span>
</h3>
<div class="para logical" id="sec-diffeqs-5-2">
<div class="para">We sometimes want to solve differential equations <span class="process-math">\(\frac{dy}{dt}=f(t,y)\)</span> for which the defining function <span class="process-math">\(f(t,y)\)</span> is discontinuous.  Here’s an example that could model an electric circuit with a switch.</div>
<div class="displaymath process-math">
\begin{equation*}
\frac{dy}{dt} = \begin{cases}
10 - y \amp \text{if } 0\leq t \leq 4 \\
-y \amp \text{if } t &gt; 4
\end{cases}\text{.}
\end{equation*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-diffeqs-5-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para logical" id="sec-diffeqs-5-3">
<div class="para">To define <span class="process-math">\(f(t,y)\)</span> in such a case, we can use <span class="process-math">\(\chi_{[a,b]}\text{,}\)</span> the characteristic function of an interval <span class="process-math">\([a,b]\text{.}\)</span>  In PreFigure, this comes in four flavors.</div>
<dl class="description-list">
<dt id="sec-diffeqs-5-3-4-1">
<code class="code-inline tex2jax_ignore">chi_oo</code><div class="autopermalink" data-description="Item: chi_oo"><a href="#sec-diffeqs-5-3-4-1" title="Copy heading and permalink for Item: chi_oo" aria-label="Copy heading and permalink for Item: chi_oo">🔗</a></div>
</dt>
<dd><div class="para" id="sec-diffeqs-5-3-4-1-2">
<code class="code-inline tex2jax_ignore">chi_oo(a,b,t)</code> is 1 if <span class="process-math">\(a \lt t \lt b\)</span> and 0 otherwise.<div class="autopermalink" data-description="Paragraph"><a href="#sec-diffeqs-5-3-4-1-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div></dd>
<dt id="sec-diffeqs-5-3-4-2">
<code class="code-inline tex2jax_ignore">chi_oc</code><div class="autopermalink" data-description="Item: chi_oc"><a href="#sec-diffeqs-5-3-4-2" title="Copy heading and permalink for Item: chi_oc" aria-label="Copy heading and permalink for Item: chi_oc">🔗</a></div>
</dt>
<dd><div class="para" id="sec-diffeqs-5-3-4-2-2">
<code class="code-inline tex2jax_ignore">chi_oc(a,b,t)</code> is 1 if <span class="process-math">\(a \lt t \leq b\)</span> and 0 otherwise.<div class="autopermalink" data-description="Paragraph"><a href="#sec-diffeqs-5-3-4-2-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div></dd>
<dt id="sec-diffeqs-5-3-4-3">
<code class="code-inline tex2jax_ignore">chi_co</code><div class="autopermalink" data-description="Item: chi_co"><a href="#sec-diffeqs-5-3-4-3" title="Copy heading and permalink for Item: chi_co" aria-label="Copy heading and permalink for Item: chi_co">🔗</a></div>
</dt>
<dd><div class="para" id="sec-diffeqs-5-3-4-3-2">
<code class="code-inline tex2jax_ignore">chi_co(a,b,t)</code> is 1 if <span class="process-math">\(a \leq t \lt b\)</span> and 0 otherwise.<div class="autopermalink" data-description="Paragraph"><a href="#sec-diffeqs-5-3-4-3-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div></dd>
<dt id="sec-diffeqs-5-3-4-4">
<code class="code-inline tex2jax_ignore">chi_cc</code><div class="autopermalink" data-description="Item: chi_cc"><a href="#sec-diffeqs-5-3-4-4" title="Copy heading and permalink for Item: chi_cc" aria-label="Copy heading and permalink for Item: chi_cc">🔗</a></div>
</dt>
<dd><div class="para" id="sec-diffeqs-5-3-4-4-2">
<code class="code-inline tex2jax_ignore">chi_cc(a,b,t)</code> is 1 if <span class="process-math">\(a \leq t \leq b\)</span> and 0 otherwise.<div class="autopermalink" data-description="Paragraph"><a href="#sec-diffeqs-5-3-4-4-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div></dd>
</dl>
<div class="autopermalink" data-description="Paragraph"><a href="#sec-diffeqs-5-3" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="para" id="sec-diffeqs-5-4">
<a href="sec-diffeqs.html#diagram-de-pulse" class="xref" data-knowl="./knowl/xref/diagram-de-pulse.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 3.8.10">Figure 3.8.10</a> illustrates how this could be used.<div class="autopermalink" data-description="Paragraph"><a href="#sec-diffeqs-5-4" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<figure class="figure figure-like" id="diagram-de-pulse"><div class="sidebyside"><div class="sbsrow" style="margin-left:20%;margin-right:20%;"><div class="sbspanel top" style="width:100%;"><img src="external/images/de-pulse.svg" role="img" class="contained"></div></div></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">3.8.10<span class="period">.</span></span><span class="space"> </span>Solving a differential equation with a discontinuity.<div class="autopermalink" data-description="Figure 3.8.10"><a href="#diagram-de-pulse" title="Copy heading and permalink for Figure 3.8.10" aria-label="Copy heading and permalink for Figure 3.8.10">🔗</a></div></figcaption></figure><figure class="listing figure-like" id="listing-de-pulse"><figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">3.8.11<span class="period">.</span></span><span class="space"> </span>The PreFigure source for Figure 3.8.10.<div class="autopermalink" data-description="Listing 3.8.11: The PreFigure source for Figure 3.8.10."><a href="#listing-de-pulse" title="Copy heading and permalink for Listing 3.8.11: The PreFigure source for Figure 3.8.10." aria-label="Copy heading and permalink for Listing 3.8.11: The PreFigure source for Figure 3.8.10.">🔗</a></div></figcaption><div class="listing__contents"><div class="code-box"><pre class="program clipboardable"><code class="language-none">&lt;diagram dimensions="(300,300)" margins="(20,5,20,25)"&gt;
  &lt;coordinates bbox="[-0.5,-2,8,20]"&gt;
    &lt;definition&gt;f(t,y)=chi_oc(-inf,4,t)*10-y&lt;/definition&gt;
    &lt;grid-axes /&gt;
    &lt;slope-field function="f" arrows="yes" stroke="gray"/&gt;
    &lt;plot-de-solution function="f" t0="0" y0="0" t1="bbox[2]"
		      max-step="0.1"/&gt;
    &lt;plot-de-solution function="f" t0="0" y0="20" t1="bbox[2]"
		      max-step="0.1"
		      stroke="red"/&gt;

    &lt;label anchor="(bbox[2],0)" alignment="ne" offset="(4,0)"&gt;
      &lt;m&gt;t&lt;/m&gt;
    &lt;/label&gt;
    &lt;label anchor="(0,bbox[3])" alignment="ne"&gt;&lt;m&gt;y(t)&lt;/m&gt;&lt;/label&gt;
  &lt;/coordinates&gt;
&lt;/diagram&gt;
</code></pre></div></div></figure><div class="para" id="sec-diffeqs-5-7">There are two additional things to note.  First, <code class="code-inline tex2jax_ignore">inf</code> can be used to represent <span class="process-math">\(\infty\text{,}\)</span> which allows us to define the interval <span class="process-math">\((-\infty, 4)\text{.}\)</span>  Second, the differential solver used by PreFigure has a hard time with discontinuities unless we specify a maximum step size for the solver to take. Notice the attribute <code class="code-inline tex2jax_ignore">@max-step="0.1"</code> in the <code class="code-inline tex2jax_ignore">&lt;plot-de-solution&gt;</code> elements.<div class="autopermalink" data-description="Paragraph"><a href="#sec-diffeqs-5-7" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Subsection 3.8.3: Discontinuities"><a href="#sec-diffeqs-5" title="Copy heading and permalink for Subsection 3.8.3: Discontinuities" aria-label="Copy heading and permalink for Subsection 3.8.3: Discontinuities">🔗</a></div></section><section class="subsection" id="subsec-delta"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">3.8.4</span><span class="space"> </span><span class="title">Delta functions</span>
</h3>
<div class="para logical" id="subsec-delta-2">
<div class="para">It is possible to define a differential equation that includes the Dirac delta function.  For example, here is the solution to the initial value problem:</div>
<div class="displaymath process-math" id="subsec-delta-2-1">
\begin{align*}
y''+y'+y \amp = 5\delta_{-2}(t) + 3\delta_1(t)\\
y(-4) \amp = 0\\
y'(-4) \amp = 0
\end{align*}
</div>
<div class="autopermalink" data-description="Paragraph"><a href="#subsec-delta-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<figure class="figure figure-like" id="diagram-de-delta"><div class="sidebyside"><div class="sbsrow" style="margin-left:20%;margin-right:20%;"><div class="sbspanel top" style="width:100%;"><img src="external/images/delta.svg" role="img" class="contained"></div></div></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">3.8.12<span class="period">.</span></span><span class="space"> </span>Solving a differential equation with delta functions.<div class="autopermalink" data-description="Figure 3.8.12"><a href="#diagram-de-delta" title="Copy heading and permalink for Figure 3.8.12" aria-label="Copy heading and permalink for Figure 3.8.12">🔗</a></div></figcaption></figure><figure class="listing figure-like" id="listing-de-delta"><figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">3.8.13<span class="period">.</span></span><span class="space"> </span>The PreFigure source for Figure 3.8.12.<div class="autopermalink" data-description="Listing 3.8.13: The PreFigure source for Figure 3.8.12."><a href="#listing-de-delta" title="Copy heading and permalink for Listing 3.8.13: The PreFigure source for Figure 3.8.12." aria-label="Copy heading and permalink for Listing 3.8.13: The PreFigure source for Figure 3.8.12.">🔗</a></div></figcaption><div class="listing__contents"><div class="code-box"><pre class="program clipboardable"><code class="language-none">&lt;diagram dimensions="(300,300)" margins="5"&gt;
  &lt;coordinates bbox="(-4,-4,4,4)"&gt;
    &lt;grid-axes decorations="yes" xlabel="t" ylabel="y"/&gt;
    &lt;definition&gt;
      f(t,y)=(y[1],-y[0]-y[1]+5*delta(t,-2)+3*delta(t,1))
    &lt;/definition&gt;
    &lt;plot-de-solution function="f" t0="-4" t1="4" y0="(0,0)"/&gt;
  &lt;/coordinates&gt;
&lt;/diagram&gt;
</code></pre></div></div></figure><div class="para" id="subsec-delta-5">Notice that the delta function takes two arguments, the first of which should correspond to the time variable and the second of which should describe the support of the delta function in the time variable.  Unpredictable, and most likely incorrect, behavior will result if the second parameter involves the value of <span class="process-math">\(y\text{.}\)</span><div class="autopermalink" data-description="Paragraph"><a href="#subsec-delta-5" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<div class="autopermalink" data-description="Subsection 3.8.4: Delta functions"><a href="#subsec-delta" title="Copy heading and permalink for Subsection 3.8.4: Delta functions" aria-label="Copy heading and permalink for Subsection 3.8.4: Delta functions">🔗</a></div></section><section class="subsection" id="subsec-euler"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">3.8.5</span><span class="space"> </span><span class="title">Euler’s method</span>
</h3>
<div class="para" id="subsec-euler-2">There is a function <code class="code-inline tex2jax_ignore">eulers_method(f, t0, y0, t1, N)</code> that returns the set of points that are the result of applying Euler’s method with the given parameters.  <a href="sec-diffeqs.html#diagram-eulers-method" class="xref" data-knowl="./knowl/xref/diagram-eulers-method.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 3.8.14">Figure 3.8.14</a> demonstrates.<div class="autopermalink" data-description="Paragraph"><a href="#subsec-euler-2" title="Copy heading and permalink for Paragraph" aria-label="Copy heading and permalink for Paragraph">🔗</a></div>
</div>
<figure class="figure figure-like" id="diagram-eulers-method"><div class="sidebyside"><div class="sbsrow" style="margin-left:20%;margin-right:20%;"><div class="sbspanel top" style="width:100%;"><img src="external/images/eulers_method.svg" role="img" class="contained"></div></div></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">3.8.14<span class="period">.</span></span><span class="space"> </span>Demonstrating Euler’s method.<div class="autopermalink" data-description="Figure 3.8.14"><a href="#diagram-eulers-method" title="Copy heading and permalink for Figure 3.8.14" aria-label="Copy heading and permalink for Figure 3.8.14">🔗</a></div></figcaption></figure><figure class="listing figure-like" id="listing-eulers-method"><figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">3.8.15<span class="period">.</span></span><span class="space"> </span>The PreFigure source for Figure 3.8.14.<div class="autopermalink" data-description="Listing 3.8.15: The PreFigure source for Figure 3.8.14."><a href="#listing-eulers-method" title="Copy heading and permalink for Listing 3.8.15: The PreFigure source for Figure 3.8.14." aria-label="Copy heading and permalink for Listing 3.8.15: The PreFigure source for Figure 3.8.14.">🔗</a></div></figcaption><div class="listing__contents"><div class="code-box"><pre class="program clipboardable"><code class="language-none">&lt;diagram dimensions="(300,300)" margins="20"&gt;
  &lt;coordinates bbox="(-1,-1,10,8)"&gt;
    &lt;definition&gt;f(t,y) = 0.1*y*(6-y)&lt;/definition&gt;
    &lt;definition&gt;N=5&lt;/definition&gt;
    &lt;definition&gt;points = eulers_method(f,0,1,bbox[2],N)&lt;/definition&gt;

    &lt;grid-axes xlabel="t" ylabel="y"/&gt;
    &lt;slope-field function="f" stroke="cornflowerblue"/&gt;
    &lt;polygon points="points" stroke="red"/&gt;

    &lt;repeat parameter="k=0..N"&gt;
      &lt;point p="points[k]"/&gt;
    &lt;/repeat&gt;
  &lt;/coordinates&gt;
&lt;/diagram&gt;
</code></pre></div></div></figure><div class="autopermalink" data-description="Subsection 3.8.5: Euler’s method"><a href="#subsec-euler" title="Copy heading and permalink for Subsection 3.8.5: Euler’s method" aria-label="Copy heading and permalink for Subsection 3.8.5: Euler’s method">🔗</a></div></section><div class="autopermalink" data-description="Section 3.8: Differential equations"><a href="#sec-diffeqs" title="Copy heading and permalink for Section 3.8: Differential equations" aria-label="Copy heading and permalink for Section 3.8: Differential equations">🔗</a></div></section></div>
<div id="ptx-content-footer" class="ptx-content-footer">
<a class="previous-button button" href="sec-calculus.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Top</span></a><a class="next-button button" href="sec-networks.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" height="100%" viewBox="338 3000 8772 6866" role="img"><title>PreTeXt logo</title><g style="stroke-width:.025in; stroke:currentColor; fill:none"><polyline points="472,3590 472,9732 " style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png" alt="Runstone Academy logo"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png" alt="MathJax logo"></a>
</div>
<script>diagcess.Base.init()</script>
</body>
</html>
